{"remainingRequest":"D:\\SIGESPRO\\sigespro\\node_modules\\@angular-devkit\\build-optimizer\\src\\build-optimizer\\webpack-loader.js??ref--3-1!D:\\SIGESPRO\\sigespro\\node_modules\\ng2-archwizard\\dist\\navigation\\semi-strict-navigation-mode.js","dependencies":[{"path":"D:\\SIGESPRO\\sigespro\\node_modules\\ng2-archwizard\\dist\\navigation\\semi-strict-navigation-mode.js","mtime":1582660892141},{"path":"D:\\SIGESPRO\\sigespro\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1582660885942},{"path":"D:\\SIGESPRO\\sigespro\\node_modules\\@angular-devkit\\build-optimizer\\src\\build-optimizer\\webpack-loader.js","mtime":1582660881929}],"contextDependencies":[],"result":["import { __extends } from \"tslib\";\r\nimport { NavigationMode } from './navigation-mode.interface';\r\nimport { MovingDirection } from '../util/moving-direction.enum';\r\nimport { WizardCompletionStep } from '../util/wizard-completion-step.interface';\r\n/**\r\n * A [[NavigationMode]], which allows the user to navigate with some limitations.\r\n * The user can only navigation to a given destination step, if:\r\n * - the current step can be exited in the direction of the destination step\r\n * - a completion step can only be entered, if all \"normal\" wizard steps have been completed\r\n *\r\n * @author Marc Arndt\r\n */\r\nvar SemiStrictNavigationMode = /*@__PURE__*/ (function (_super) {\r\n    __extends(SemiStrictNavigationMode, _super);\r\n    /**\r\n     * Constructor\r\n     *\r\n     * @param {WizardState} wizardState The model/state of the wizard, that is configured with this navigation mode\r\n     */\r\n    function SemiStrictNavigationMode(wizardState) {\r\n        return _super.call(this, wizardState) || this;\r\n    }\r\n    /**\r\n     * Checks whether the wizard can be transitioned to the given destination step.\r\n     * A destination wizard step can be entered if:\r\n     * - it exists\r\n     * - the current step can be exited in the direction of the destination step\r\n     * - all \"normal\" wizard steps have been completed, are optional or selected, or the destination step isn't a completion step\r\n     *\r\n     * @param {number} destinationIndex The index of the destination wizard step\r\n     * @returns {boolean} True if the destination wizard step can be entered, false otherwise\r\n     */\r\n    SemiStrictNavigationMode.prototype.canGoToStep = function (destinationIndex) {\r\n        var _this = this;\r\n        var hasStep = this.wizardState.hasStep(destinationIndex);\r\n        var movingDirection = this.wizardState.getMovingDirection(destinationIndex);\r\n        var canExitCurrentStep = function (previous) {\r\n            return previous ? _this.wizardState.currentStep.canExitStep(movingDirection) : Promise.resolve(false);\r\n        };\r\n        var canEnterDestinationStep = function (previous) {\r\n            return previous ? _this.wizardState.getStepAtIndex(destinationIndex).canEnterStep(movingDirection) : Promise.resolve(false);\r\n        };\r\n        // provide the destination step as a lambda in case the index doesn't exist (i.e. hasStep === false)\r\n        var destinationStep = function (previous) {\r\n            if (previous) {\r\n                var allNormalStepsCompleted = _this.wizardState.wizardSteps\r\n                    .filter(function (step, index) { return index < destinationIndex; })\r\n                    .every(function (step) { return step.completed || step.optional || step.selected; });\r\n                return Promise.resolve(!(_this.wizardState.getStepAtIndex(destinationIndex) instanceof WizardCompletionStep) || allNormalStepsCompleted);\r\n            }\r\n            else {\r\n                return Promise.resolve(false);\r\n            }\r\n        };\r\n        return Promise.resolve(hasStep)\r\n            .then(canExitCurrentStep)\r\n            .then(canEnterDestinationStep)\r\n            .then(destinationStep);\r\n    };\r\n    /**\r\n     * Tries to enter the wizard step with the given destination index.\r\n     * When entering the destination step, the following actions are done:\r\n     * - the old current step is set as completed\r\n     * - the old current step is set as unselected\r\n     * - the old current step is exited\r\n     * - the destination step is set as selected\r\n     * - the destination step is entered\r\n     *\r\n     * When the destination step couldn't be entered, the following actions are done:\r\n     * - the current step is exited and entered in the direction `MovingDirection.Stay`\r\n     *\r\n     * @param {number} destinationIndex The index of the destination wizard step, which should be entered\r\n     * @param {EventEmitter<void>} preFinalize An event emitter, to be called before the step has been transitioned\r\n     * @param {EventEmitter<void>} postFinalize An event emitter, to be called after the step has been transitioned\r\n     */\r\n    SemiStrictNavigationMode.prototype.goToStep = function (destinationIndex, preFinalize, postFinalize) {\r\n        var _this = this;\r\n        this.canGoToStep(destinationIndex).then(function (navigationAllowed) {\r\n            if (navigationAllowed) {\r\n                // the current step can be exited in the given direction\r\n                var movingDirection = _this.wizardState.getMovingDirection(destinationIndex);\r\n                /* istanbul ignore if */\r\n                if (preFinalize) {\r\n                    preFinalize.emit();\r\n                }\r\n                // leave current step\r\n                _this.wizardState.currentStep.completed = true;\r\n                _this.wizardState.currentStep.exit(movingDirection);\r\n                _this.wizardState.currentStep.selected = false;\r\n                _this.wizardState.currentStepIndex = destinationIndex;\r\n                // go to next step\r\n                _this.wizardState.currentStep.enter(movingDirection);\r\n                _this.wizardState.currentStep.selected = true;\r\n                /* istanbul ignore if */\r\n                if (postFinalize) {\r\n                    postFinalize.emit();\r\n                }\r\n            }\r\n            else {\r\n                // if the current step can't be left, reenter the current step\r\n                _this.wizardState.currentStep.exit(MovingDirection.Stay);\r\n                _this.wizardState.currentStep.enter(MovingDirection.Stay);\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    SemiStrictNavigationMode.prototype.isNavigable = function (destinationIndex) {\r\n        if (this.wizardState.getStepAtIndex(destinationIndex) instanceof WizardCompletionStep) {\r\n            // a completion step can only be entered, if all previous steps have been completed, are optional, or selected\r\n            return this.wizardState.wizardSteps.filter(function (step, index) { return index < destinationIndex; })\r\n                .every(function (step) { return step.completed || step.optional || step.selected; });\r\n        }\r\n        else {\r\n            // a \"normal\" step can always be entered\r\n            return true;\r\n        }\r\n    };\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    SemiStrictNavigationMode.prototype.reset = function () {\r\n        // the wizard doesn't contain a step with the default step index\r\n        if (!this.wizardState.hasStep(this.wizardState.defaultStepIndex)) {\r\n            throw new Error(\"The wizard doesn't contain a step with index \" + this.wizardState.defaultStepIndex);\r\n        }\r\n        // the default step is a completion step and the wizard contains more than one step\r\n        var defaultCompletionStep = this.wizardState.getStepAtIndex(this.wizardState.defaultStepIndex) instanceof WizardCompletionStep &&\r\n            this.wizardState.wizardSteps.length !== 1;\r\n        if (defaultCompletionStep) {\r\n            throw new Error(\"The default step index \" + this.wizardState.defaultStepIndex + \" references a completion step\");\r\n        }\r\n        // reset the step internal state\r\n        this.wizardState.wizardSteps.forEach(function (step) {\r\n            step.completed = false;\r\n            step.selected = false;\r\n        });\r\n        // set the first step as the current step\r\n        this.wizardState.currentStepIndex = this.wizardState.defaultStepIndex;\r\n        this.wizardState.currentStep.selected = true;\r\n        this.wizardState.currentStep.enter(MovingDirection.Forwards);\r\n    };\r\n    return SemiStrictNavigationMode;\r\n}(NavigationMode));\r\nexport { SemiStrictNavigationMode };\r\n//# sourceMappingURL=semi-strict-navigation-mode.js.map \r\n",null]}